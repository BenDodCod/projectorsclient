{
  "id": "high-memory",
  "title": "Excessive Memory Usage (>200 MB)",
  "category": "troubleshooting",
  "keywords": ["memory", "ram", "usage", "leak", "high memory", "performance"],
  "content": "## Symptom\n\nApplication uses more than 200 MB of RAM (normal usage: 100-150 MB).\n\n## Diagnosis\n\n**Check memory usage:**\n1. Open Task Manager (Ctrl+Shift+Esc)\n2. Click **Processes** tab\n3. Find \"ProjectorControl.exe\"\n4. Look at **Memory** column\n5. Compare to target: <150 MB normal, <200 MB maximum\n\n**Monitor over time:**\n- Note initial memory usage after startup\n- Watch memory after several hours of use\n- If memory continuously increases → Possible memory leak\n\n## Common Causes\n\n**Large operation history:**\n- Thousands of history entries stored in memory\n- Each entry consumes ~1-2 KB\n- 10,000 entries = 10-20 MB overhead\n- Accumulates over weeks/months of use\n\n**Debug mode enabled:**\n- Generates large in-memory log buffers\n- Debug logging very verbose\n- Can consume 50-100 MB extra\n- Not intended for normal use\n\n**Many projectors configured:**\n- Each projector has status cache\n- Multiple connection pools\n- Normal for large installations\n- 10+ projectors may use 200-250 MB\n\n**Memory leak (rare):**\n- Memory continuously increases over time\n- Never decreases\n- Eventually causes slowdown or crash\n- Should be reported to support\n\n## Solutions\n\n**Immediate fixes:**\n\n1. **Clear operation history:**\n   - Settings > Diagnostics > Clear History Cache\n   - Removes all history entries from memory and disk\n   - Immediately reduces memory usage\n   - **Note:** Cannot be undone\n\n2. **Disable debug mode:**\n   - Settings > Advanced > Developer Options > Uncheck \"Enable debug mode\"\n   - Reduces log buffer size\n   - Improves performance\n\n3. **Restart application:**\n   - Close completely (Exit from system tray)\n   - Relaunch\n   - Frees all accumulated memory\n   - Temporary fix if leak suspected\n\n**Long-term solutions:**\n\n1. **Regular history cleanup:**\n   - Clear history weekly or monthly\n   - Prevents accumulation\n   - Automated cleanup planned for future version\n\n2. **Reduce status update frequency:**\n   - Settings > Connection > Status Update Interval → 10-15 seconds\n   - Reduces network activity\n   - Slightly reduces memory churn\n\n3. **Disable unused projectors:**\n   - If many projectors configured but rarely used\n   - Remove or disable them\n   - Reduces memory footprint\n\n## Investigating Memory Leaks\n\n**If memory continuously increases:**\n\n1. **Restart app and monitor:**\n   - Note memory on startup (baseline)\n   - Perform normal operations for 1 hour\n   - Check memory again\n   - Expected increase: <10 MB/hour\n   - Concerning: >50 MB/hour\n\n2. **Isolate the cause:**\n   - Use app minimally (no operations)\n   - Does memory still increase? → Leak in background task\n   - Only increases with operations? → Leak in command handling\n   - Note which operations trigger increase\n\n3. **Export diagnostic report:**\n   - Settings > Diagnostics > Export Diagnostic Report\n   - Include memory usage screenshots from Task Manager\n   - Report to IT or support\n\n## Expected Memory Usage\n\n**Baseline (idle):**\n- 1 projector: 80-100 MB\n- 5 projectors: 120-140 MB\n- 10+ projectors: 150-200 MB\n\n**During operations:**\n- Add 10-20 MB temporary spike\n- Should return to baseline after operation\n\n**With debug mode:**\n- Add 50-100 MB\n- Not recommended for normal use\n\n**With large history (10,000+ entries):**\n- Add 10-30 MB\n- Clear history to reduce\n\n## When to Contact Support\n\n- Memory >300 MB with single projector\n- Memory continuously increases (>50 MB/hour)\n- Application becomes sluggish\n- Crashes due to out-of-memory\n- Memory usage after clearing history still high\n\n## Performance Impact\n\n**Normal memory usage (<200 MB):**\n- No performance impact\n- Fast and responsive\n\n**High memory usage (200-400 MB):**\n- Minor impact\n- May affect other applications\n- Should investigate cause\n\n**Excessive memory (>400 MB):**\n- Definitely a problem\n- Slows down computer\n- Report immediately\n\n> **Tip:** Regularly clear operation history (Settings > Diagnostics > Clear History Cache) to keep memory usage low. This is safe and recommended monthly.",
  "related_topics": ["diagnostics-settings", "advanced-settings", "slow-startup"],
  "screenshots": []
}
